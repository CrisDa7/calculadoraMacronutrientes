<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>CRISS FITT</title>
<link rel="icon" href="logo.png" type="image/png" />

<!-- Tailwind CDN -->
<script src="https://cdn.tailwindcss.com"></script>
<script>
tailwind.config = {
  theme: {
    extend: {
      colors: {
        brand: {50:'#e9f0ff',100:'#d7e5ff',200:'#b4ceff',300:'#8cb3ff',400:'#5e94ff',500:'#3a7cff',600:'#2c66e6',700:'#214fc0',800:'#1b419a',900:'#173a83'}
      }
    }
  }
}
</script>
<style>
  :root{
    --control-h: 44px;
    --radius: 12px;
  }

  /* ===== Fondo con tu foto + overlay ===== */
  body{
    background: url('yo.jpg') center / cover fixed no-repeat, #0a0b0d;
    color:#e5e7eb; min-height:100vh;
  }
  body::before{
    content:""; position:fixed; inset:0;
    background:linear-gradient(180deg, rgba(0,0,0,.60), rgba(0,0,0,.82));
    pointer-events:none; z-index:-1;
  }

  /* ===== Cards flotando (glass) ===== */
  .card{
    border:1px solid rgba(255,255,255,.10);
    background:rgba(15,16,20,.46);
    border-radius:16px;
    box-shadow: 0 12px 30px rgba(0,0,0,.35);
    backdrop-filter: blur(8px);
    -webkit-backdrop-filter: blur(8px);
  }

  /* ===== Controles uniformes ===== */
  .control{
    height:var(--control-h); min-height:var(--control-h);
    border-radius:var(--radius);
    font-size:14px;
  }
  .field{
    width:100%;
    background:rgba(255,255,255,.06);
    border:1px solid rgba(255,255,255,.12);
    padding:0 .9rem;
    color:#e5e7eb;
    outline:none;
    transition:border-color .15s ease, box-shadow .15s ease, background .15s ease;
  }
  .field:focus{
    border-color:rgba(94,148,255,.55);
    box-shadow:0 0 0 3px rgba(94,148,255,.18);
    background:rgba(255,255,255,.08);
  }

  /* Select estilizado */
  .select-wrap{ position:relative; }
  .select-wrap::after{
    content:"‚ñæ";
    position:absolute; right:.7rem; top:50%;
    transform:translateY(-50%);
    color:#94b2ff; font-size:14px; pointer-events:none;
  }
  select.field{
    appearance:none; -webkit-appearance:none; -moz-appearance:none;
    padding-right:2rem;
    color-scheme: dark;
  }
  select.field option{ background:#0b0c10; color:#e5e7eb; }

  /* Botones iguales en alto y padding */
  .btn{
    height:var(--control-h); min-height:var(--control-h);
    border-radius:var(--radius);
    border:1px solid rgba(255,255,255,.12);
    background:rgba(255,255,255,.08);
    padding:0 1rem;
    font-weight:600; letter-spacing:.2px;
    transition:.18s ease;
  }
  .btn:hover{ background:rgba(255,255,255,.14); }
  .btn-primary{
    background:linear-gradient(180deg,#3a7cff,#2c66e6);
    border-color:#2c66e6; color:#fff;
  }
  .btn-primary:hover{ filter:brightness(1.05); }

  /* ===== Modal deslizante ===== */
  .modal-bg{
    position:fixed; inset:0; display:flex; align-items:center; justify-content:center; padding:1rem;
    background:rgba(0,0,0,.72); opacity:0; visibility:hidden; pointer-events:none;
    transition:opacity .22s ease, visibility .22s ease;
  }
  .modal-bg.open{ opacity:1; visibility:visible; pointer-events:auto; }
  .modal{
    width:100%; max-width:900px; border-radius:18px;
    border:1px solid rgba(255,255,255,.12); background:#0b0b0c;
    transform:translateY(22px) scale(.98); opacity:0;
    transition:transform .26s ease, opacity .26s ease;
  }
  .modal-bg.open .modal{ transform:translateY(0) scale(1); opacity:1; }

  /* ===== Panel negro con halo azul (para modales) ===== */
  .panel-base{
    border-radius:16px; padding:16px;
    box-shadow: 0 10px 30px rgba(0,0,0,.55), inset 0 0 0 1px rgba(255,255,255,.05);
    border:1px solid rgba(94,148,255,.28);
  }
  .panel-black{
    background:
      radial-gradient(1200px 400px at 50% -10%, rgba(58,124,255,.10), transparent 60%),
      linear-gradient(135deg, rgba(12,14,18,.98), rgba(10,12,16,.98));
  }

  /* Pulso azul (recuerda) */
  @keyframes pulse-blue{
    0%{ transform:scale(1); filter:drop-shadow(0 0 0 rgba(94,148,255,0)); }
    50%{ transform:scale(1.06); filter:drop-shadow(0 0 22px rgba(94,148,255,.65)); }
    100%{ transform:scale(1); filter:drop-shadow(0 0 0 rgba(94,148,255,0)); }
  }
  .pulse{ animation:pulse-blue 2.1s ease-in-out infinite; }
  .symbol{ font-weight:900; line-height:1; user-select:none; text-shadow:0 0 18px rgba(94,148,255,.6); }

  table{width:100%; border-collapse:separate; border-spacing:0 .5rem}
  td,th{padding:.4rem .6rem}
  th{font-size:.75rem; color:#94a3b8; text-align:left}
</style>
</head>
<body class="selection:bg-brand-500/30">
  <!-- ===== Header: logo + saludo ===== -->
  <header class="sticky top-0 z-10 bg-black/55 backdrop-blur border-b border-white/10">
    <div class="max-w-6xl mx-auto px-4 py-3 flex items-center justify-between gap-3">
      <div class="flex items-center">
        <img src="logo.png" alt="CRISS FITT" class="h-12 sm:h-14 w-auto rounded-md shadow" />
      </div>
      <div class="hidden xs:block text-sm sm:text-base font-semibold tracking-wide">
        <span class="text-slate-300">Bienvenido, te saluda</span>
        <span class="text-brand-400"> Cristian</span> <span aria-hidden="true">üëã</span>
      </div>
    </div>
  </header>

  <!-- ===== Main ===== -->
  <main class="max-w-6xl mx-auto px-4 py-8 min-h-screen">
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
      <!-- Entrada -->
      <section class="card p-5 space-y-5">
        <h2 class="font-semibold text-lg">Datos</h2>

        <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
          <div>
            <label class="text-sm text-slate-300">Sexo</label>
            <div class="select-wrap">
              <select id="sex" class="field control">
                <option value="male">Hombre</option>
                <option value="female">Mujer</option>
              </select>
            </div>
          </div>
          <div>
            <label class="text-sm text-slate-300">Edad (a√±os)</label>
            <input id="age" type="number" min="15" max="75" value="28" class="field control" />
          </div>
        </div>

        <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
          <div>
            <label class="text-sm text-slate-300">Peso (kg)</label>
            <input id="weight" type="number" min="35" max="250" value="75" class="field control" />
          </div>
          <div>
            <label class="text-sm text-slate-300">Estatura (cm)</label>
            <input id="heightCm" type="number" min="140" max="220" value="175" class="field control" />
          </div>
        </div>

        <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
          <div>
            <label class="text-sm text-slate-300">Nivel de actividad</label>
            <div class="select-wrap">
              <select id="activity" class="field control">
                <option value="1.2">Sedentario (poco o nada)</option>
                <option value="1.375">Ligero (1‚Äì3 d√≠as/sem)</option>
                <option value="1.55" selected>Moderado (3‚Äì5 d√≠as/sem)</option>
                <option value="1.725">Activo (6‚Äì7 d√≠as/sem)</option>
                <option value="1.9">Muy activo (intenso + trabajo f√≠sico)</option>
              </select>
            </div>
          </div>
          <div>
            <label class="text-sm text-slate-300">Objetivo</label>
            <div class="select-wrap">
              <select id="goal" class="field control">
                <option value="maintain">Mantener</option>
                <option value="cut">Bajar grasa (‚Äì10%)</option>
                <option value="bulk" selected>Ganar masa (+10%)</option>
              </select>
            </div>
          </div>
        </div>

        <div class="grid grid-cols-1 sm:grid-cols-3 gap-2">
          <button id="calcBtn" class="btn btn-primary">Calcular</button>
          <button id="detailsBtn" class="btn">Ver detalles</button>
          <button id="rememberBtn" class="btn">Recuerda</button>
        </div>

        <p class="text-xs text-slate-300/80">Uso recomendado para adultos sanos. Si tienes condiciones m√©dicas (p. ej., embarazo, ri√±√≥n), consulta a un profesional de salud.</p>
      </section>

      <!-- Resultados num√©ricos -->
      <section class="card p-5 space-y-5">
        <div class="grid grid-cols-2 gap-4">
          <div class="card p-4">
            <div class="text-[11px] uppercase tracking-wide text-slate-400">Ecuaci√≥n usada</div>
            <div id="eqUsed" class="text-sm font-medium text-slate-200">Mifflin‚ÄìSt Jeor</div>
          </div>
          <div class="card p-4">
            <div class="text-[11px] uppercase tracking-wide text-slate-400">GET mantenimiento (kcal)</div>
            <div id="get" class="text-2xl font-bold text-slate-50">0</div>
          </div>
        </div>

        <div class="grid grid-cols-2 gap-4">
          <div class="card p-4">
            <div class="text-[11px] uppercase tracking-wide text-slate-400">TMB (kcal)</div>
            <div id="tmb" class="text-2xl font-bold text-slate-50">0</div>
          </div>
          <div class="card p-4">
            <div class="text-[11px] uppercase tracking-wide text-slate-400">Calor√≠as objetivo</div>
            <div id="targetKcal" class="text-2xl font-bold text-slate-50">0</div>
            <div id="adjText" class="text-xs text-slate-400 mt-1">‚Äî</div>
          </div>
        </div>

        <div class="card p-4">
          <div class="grid grid-cols-3 gap-3">
            <div class="card p-3">
              <div class="text-slate-300 font-medium">Prote√≠na</div>
              <div id="pGrams" class="text-slate-50 text-lg font-semibold">0 g</div>
              <div id="pInfo" class="text-slate-400 text-xs">‚Äî</div>
            </div>
            <div class="card p-3">
              <div class="text-slate-300 font-medium">Grasas</div>
              <div id="fGrams" class="text-slate-50 text-lg font-semibold">0 g</div>
              <div id="fInfo" class="text-slate-400 text-xs">‚Äî</div>
            </div>
            <div class="card p-3">
              <div class="text-slate-300 font-medium">Carbohidratos</div>
              <div id="cGrams" class="text-slate-50 text-lg font-semibold">0 g</div>
              <div id="cInfo" class="text-slate-400 text-xs">‚Äî</div>
            </div>
          </div>
        </div>

        <details class="text-xs text-slate-300/80 leading-relaxed">
          <summary class="cursor-pointer text-slate-400">Fuentes y notas</summary>
          <ul class="list-disc pl-5 mt-2 space-y-1">
            <li>Mifflin‚ÄìSt Jeor (1990) para TMB; multiplicador de actividad para GET.</li>
            <li>Macros orientativas por kg: Mantener 1.8/0.8 g/kg, D√©ficit 2.2/0.8 g/kg, Super√°vit 2.0/1.0 g/kg.</li>
            <li>Ajuste fijo de objetivo: ¬±10% del mantenimiento.</li>
          </ul>
        </details>
      </section>
    </div>
  </main>

  <footer class="max-w-6xl mx-auto px-4 pb-10 mt-8 text-center text-xs text-slate-300/80">
    ¬© <span id="year"></span> CRISS <span class="text-brand-500">FITT</span> ¬∑ Herramienta educativa.
  </footer>

  <!-- ===== Modal reutilizable ===== -->
  <div id="modalBg" class="modal-bg" aria-hidden="true">
    <div class="modal p-5 md:p-6">
      <div class="flex items-center justify-between gap-3">
        <h3 id="modalTitle" class="text-lg font-semibold">Detalles</h3>
        <button id="closeModal" class="btn">Cerrar</button>
      </div>
      <div id="modalContent" class="mt-4 space-y-4 text-base leading-relaxed text-slate-300"></div>
    </div>
  </div>

<!-- ================= L√ìGICA ================= -->
<script>
/* Utilidades */
const clamp=(v,min,max)=>Math.max(min,Math.min(max,v));
const toNumber=(v,d=0)=>{const n=Number(String(v).replace(",", "."));return Number.isFinite(n)?n:d;}
const round=(n,d=0)=>{const p=10**d;return Math.round(n*p)/p;}

/* Inputs */
const sex=document.getElementById('sex');
const age=document.getElementById('age');
const weight=document.getElementById('weight');
const heightCm=document.getElementById('heightCm');
const activity=document.getElementById('activity');
const goal=document.getElementById('goal');

/* UI */
const calcBtn=document.getElementById('calcBtn');
const detailsBtn=document.getElementById('detailsBtn');
const rememberBtn=document.getElementById('rememberBtn');

const eqUsed=document.getElementById('eqUsed');
const tmbEl=document.getElementById('tmb');
const getEl=document.getElementById('get');
const targetKcalEl=document.getElementById('targetKcal');
const adjText=document.getElementById('adjText');
const pGrams=document.getElementById('pGrams');
const fGrams=document.getElementById('fGrams');
const cGrams=document.getElementById('cGrams');
const pInfo=document.getElementById('pInfo');
const fInfo=document.getElementById('fInfo');
const cInfo=document.getElementById('cInfo');

/* Modal */
const modalBg=document.getElementById('modalBg');
const modalTitle=document.getElementById('modalTitle');
const modalContent=document.getElementById('modalContent');
const closeModal=document.getElementById('closeModal');

function weightKg(){return toNumber(weight.value,0);}
function heightCmVal(){return toNumber(heightCm.value,0);}

function calcTMB(){
  const a=toNumber(age.value,0);
  const w=clamp(weightKg(),0,400);
  const h=clamp(heightCmVal(),0,260);
  eqUsed.textContent='Mifflin‚ÄìSt Jeor';
  return Math.max(0, 10*w + 6.25*h - 5*a + (sex.value==='male'?5:-161));
}
function calcGET(tmb){return tmb * toNumber(activity.value,1.55);}

function macrosByGoal(g){
  if(g==='cut')  return {pPerKg:2.2, fPerKg:0.8, adj:-0.10, label:'D√©ficit 10%'};
  if(g==='bulk') return {pPerKg:2.0, fPerKg:1.0, adj:+0.10, label:'Super√°vit 10%'};
  return {pPerKg:1.8, fPerKg:0.8, adj:0.0, label:'Mantener (0%)'};
}

/* Reparto exacto que suma el total */
function splitEven(total, parts){
  const base = Math.floor(total/parts);
  const arr  = Array(parts).fill(base);
  let rem = total - base*parts;
  for(let i=arr.length-1; i>=0 && rem>0; i--){ arr[i]+=1; rem--; }
  return arr;
}

/* Texto humano (modal Detalles) */
function renderHumanReadout({label, target, pG, fG, cG, meals, weeklyText, safetyMsgs}) {
  const m4 = meals.find(m => m.n === 4) || meals[0];
  const prot3 = meals.find(m => m.n === 3)?.p?.[0] ?? '';
  const prot4 = m4?.p?.[0] ?? '';
  const prot5 = meals.find(m => m.n === 5)?.p?.[0] ?? '';

  return `
    <div class="panel-base panel-black">
      <p><b>Tu objetivo diario:</b> <b>${Math.round(target)} kcal</b> (${label.toLowerCase()}).</p>
      <p><b>Prote√≠na diaria:</b> <b>${Math.round(pG)} g</b>. Reparte la prote√≠na en todas tus comidas:
        con <b>3 comidas</b> ‚âà <b>${prot3} g</b> por comida; con <b>4 comidas</b> ‚âà <b>${prot4} g</b>; con <b>5 comidas</b> ‚âà <b>${prot5} g</b>.</p>
      <p><b>Grasas diarias:</b> <b>${Math.round(fG)} g</b>. Gu√≠a pr√°ctica: ~<b>15‚Äì25 g</b> por comida.</p>
      <p><b>Carbohidratos diarios:</b> <b>${Math.round(cG)} g</b>. Pon m√°s carbohidrato <b>antes y/o despu√©s</b> de entrenar.</p>
      <p><b>C√≥mo aplicarlo hoy:</b> si haces <b>4 comidas</b>, distribuye <b>${m4.kcal.join(' / ')}</b> kcal y
        <b>${m4.p.join(' / ')} g prote√≠na</b> ¬∑ <b>${m4.f.join(' / ')} g grasa</b> ¬∑ <b>${m4.c.join(' / ')} g carbos</b> en cada una.</p>
      <p><b>¬øDebo ‚Äúquemar‚Äù calor√≠as?</b> No necesitas un n√∫mero exacto: tu objetivo de <b>${Math.round(target)} kcal</b> ya contempla tu gasto.</p>
      <p class="text-slate-400">${weeklyText}</p>
      ${safetyMsgs.length? `<div class="text-xs text-slate-400 space-y-1">${safetyMsgs.map(m=>`<div>${m}</div>`).join('')}</div>`:''}
    </div>
  `;
}

/* Bloque ‚ÄúRecuerda‚Äù */
function renderRememberBlock(){
  return `
    <div class="panel-base panel-black">
      <div class="text-center mb-3 font-semibold">
        Nunca olvides estos <span class="text-brand-400">3</span> pasos clave
      </div>
      <div class="flex items-center justify-center gap-3 sm:gap-4 md:gap-6 flex-wrap">
        <img src="comida.png" alt="Comida" class="w-20 sm:w-24 md:w-28 h-auto rounded-xl pulse" />
        <div class="symbol text-brand-400 text-4xl sm:text-5xl md:text-6xl">+</div>
        <img src="descanso.png" alt="Descanso" class="w-20 sm:w-24 md:w-28 h-auto rounded-xl pulse" style="animation-delay:.2s"/>
        <div class="symbol text-brand-400 text-4xl sm:text-5xl md:text-6xl">+</div>
        <img src="ejercicio.png" alt="Ejercicio" class="w-20 sm:w-24 md:w-28 h-auto rounded-xl pulse" style="animation-delay:.4s"/>
        <div class="symbol text-brand-400 text-4xl sm:text-5xl md:text-6xl">=</div>
        <img src="fuerte.png" alt="Fuerte" class="w-24 sm:w-28 md:w-32 h-auto rounded-2xl pulse" style="animation-delay:.6s"/>
      </div>
    </div>
  `;
}

/* C√°lculo principal */
function compute(){
  const TMB=calcTMB();
  const GET=calcGET(TMB);
  const {pPerKg,fPerKg,adj,label}=macrosByGoal(goal.value);
  const target = GET*(1+adj);

  const kg = weightKg();
  const pG = kg * pPerKg;
  const fG = kg * fPerKg;
  const kcalP = pG*4, kcalF = fG*9;
  const cG = Math.max(0,(target - (kcalP + kcalF))/4);

  // N√∫meros b√°sicos en tarjetas
  tmbEl.textContent=round(TMB);
  getEl.textContent=round(GET);
  targetKcalEl.textContent=round(target);
  adjText.textContent=`${label}. Tu mantenimiento es ${round(GET)} kcal; objetivo ${round(target)} kcal/d√≠a.`;

  pGrams.textContent=`${round(pG)} g`;  fGrams.textContent=`${round(fG)} g`;  cGrams.textContent=`${round(cG)} g`;
  pInfo.textContent=`${pPerKg.toFixed(2)} g/kg √ó ${round(kg)} kg = ${round(pG)} g`;
  fInfo.textContent=`${fPerKg.toFixed(2)} g/kg √ó ${round(kg)} kg = ${round(fG)} g`;
  cInfo.textContent=`(Objetivo ‚àí prote√≠nas ‚àí grasas) √∑ 4`;

  // Estimado semanal
  const delta = target - GET;
  const weeklyKg = (delta*7)/7700;
  const pctBody = (weeklyKg/Math.max(kg,1))*100;
  const weeklyText = (goal.value==='maintain')
    ? 'Mantenimiento: cambios de peso peque√±os son normales.'
    : `Estimado de cambio: ${weeklyKg>=0?'+':''}${round(weeklyKg,2)} kg/sem (‚âà ${round(pctBody,2)}%/sem). Recomendado: 0.25‚Äì0.5%/sem.`;

  // Seguridad
  const safetyMsgs=[];
  if(target < TMB) safetyMsgs.push('‚ö†Ô∏è Objetivo por debajo de tu TMB. Sube calor√≠as.');
  const fatPct = ((fG*9)/(target||1))*100;
  if(fatPct < 20) safetyMsgs.push('‚ÑπÔ∏è La grasa queda < 20% de las kcal. A largo plazo conviene ‚â•20%.');

  // Reparto exacto 3-4-5 comidas
  const meals=[3,4,5].map(n=>({
    n,
    kcal: splitEven(Math.round(target),n),
    p: splitEven(Math.round(pG),n),
    f: splitEven(Math.round(fG),n),
    c: splitEven(Math.round(cG),n)
  }));

  // Guardar para los modales
  window.__plan = {label, target, pG, fG, cG, meals, weeklyText, safetyMsgs};
}

/* Modal helpers */
function openModal(title, html){
  modalTitle.textContent = title;
  modalContent.innerHTML = html;
  modalBg.classList.add('open');
  modalBg.setAttribute('aria-hidden','false');
}
function closeModalFn(){ modalBg.classList.remove('open'); modalBg.setAttribute('aria-hidden','true'); }

/* Init */
document.getElementById('year').textContent=new Date().getFullYear();

calcBtn.addEventListener('click', compute);
detailsBtn.addEventListener('click', ()=>{
  if(!window.__plan) compute();
  const html = renderHumanReadout(window.__plan);
  openModal('C√≥mo usar tu plan', html);
});
rememberBtn.addEventListener('click', ()=>{
  const block = renderRememberBlock();
  openModal('Recuerda', block);
});
closeModal.addEventListener('click', closeModalFn);
modalBg.addEventListener('click', (e)=>{ if(e.target===modalBg) closeModalFn(); });
document.addEventListener('keydown', (e)=>{ if(e.key==='Escape') closeModalFn(); });

/* C√°lculo inicial */
compute();
</script>
</body>
</html>
